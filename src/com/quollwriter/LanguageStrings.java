package com.quollwriter;

import java.util.*;

public class LanguageStrings
{
    
    public static final String project = "project";
    public static final String settingsmenu = "settingsmenu";
    public static final String items = "items";
    
    public static final String renameproject = "renameproject";
    public static final String statistics = "statistics";
    public static final String targets = "targets";
    public static final String createbackup = "createbackup";
    public static final String openproject = "openproject";
    public static final String newproject = "newproject";
    public static final String deleteproject = "deleteproject";
    public static final String closeproject = "closeproject";
    public static final String exportproject = "exportproject";
    public static final String ideaboard = "ideaboard";
    public static final String dowarmup = "dowarmup";
    
    public static final String actionerror = "actionerror";
    public static final String label = "label";
    public static final String filetype = "filetype";
    public static final String stages = "stages";
    public static final String wheretosave = "wheretosave";
    public static final String finder = "finder";
    public static final String tooltip = "tooltip";
    public static final String button = "button";
    public static final String title = "title";
    public static final String text = "text";
    public static final String help = "help";
    public static final String nexterror = "nexterror";
    public static final String previouserror = "previouserror";
    public static final String exportcompletepopup = "exportcompletepopup";
    public static final String nodirselectederror = "nodirselectederror";
    public static final String sectiontitles = "sectiontitles";
    public static final String plan = "plan";
    public static final String goals = "goals";
    public static final String assets = "assets";
    public static final String notes = "notes";
    public static final String scenesoutlineitems = "scenesoutlineitems";
    public static final String chapterinfo = "chapterinfo";
    public static final String howtosave = "howtosave";
    public static final String otheritemslabel = "otheritemslabel";
    public static final String onefileperitemtype = "onefileperitemtype";
    public static final String types = "types";
    public static final String singlefile = "singlefile";
    public static final String chapterslabel = "chapterslabel";
    public static final String onefileperchapter = "onefileperchapter";
    public static final String selectitems = "selectitems";
    public static final String importproject = "importproject";
    public static final String projectslist = "projectslist";
    public static final String selectproject = "selectproject";
    public static final String getallprojectserror = "getallprojectserror";
    public static final String moretextindicator = "moretextindicator";
    public static final String choose = "choose";
    public static final String importfromfile = "importfromfile";
    public static final String options = "options";
    public static final String importfromproject = "importfromproject";
    public static final String selectfile = "selectfile";
    public static final String decide = "decide";
    public static final String textextra = "textextra";
    public static final String addtoproject = "addtoproject";
    public static final String importcompletepopup = "importcompletepopup";
    public static final String unabletosaveerror = "unabletosaveerror";
    public static final String supportedfiletypesdescription = "supportedfiletypesdescription";
    public static final String unabletocreateprojecterror = "unabletocreateprojecterror";
    public static final String nofileselectederror = "nofileselectederror";
    public static final String popup = "popup";
    public static final String wizard = "wizard";
    public static final String buttons = "buttons";
    public static final String confirm = "confirm";
    public static final String problemfinder = "problemfinder";
    public static final String config = "config";
    public static final String removerule = "removerule";
    public static final String thisproject = "thisproject";
    public static final String allprojects = "allprojects";
    public static final String rulebox = "rulebox";
    public static final String find = "find";
    public static final String info = "info";
    public static final String delete = "delete";
    public static final String edit = "edit";
    public static final String sentence = "sentence";
    public static final String paragraph = "paragraph";
    public static final String words = "words";
    public static final String addrule = "addrule";
    public static final String editrule = "editrule";
    public static final String add = "add";
    public static final String saveruleerror = "saveruleerror";
    public static final String tabtitles = "tabtitles";
    public static final String form = "form";
    public static final String labels = "labels";
    public static final String summary = "summary";
    public static final String description = "description";
    public static final String errors = "errors";
    public static final String entervalue = "entervalue";
    public static final String wordfinder = "wordfinder";
    public static final String passivesentence = "passivesentence";
    public static final String adverb = "adverb";
    public static final String wordphrase = "wordphrase";
    public static final String anywhere = "anywhere";
    public static final String where = "where";
    public static final String startofsentence = "startofsentence";
    public static final String endofsentence = "endofsentence";
    public static final String onlyindialogue = "onlyindialogue";
    public static final String ignoreindialogue = "ignoreindialogue";
    public static final String nowordserror = "nowordserror";
    public static final String rules = "rules";
    public static final String issues = "issues";
    public static final String suffixes = "suffixes";
    public static final String notindialogue = "notindialogue";
    public static final String indialogue = "indialogue";
    public static final String edittitle = "edittitle";
    public static final String insentence = "insentence";
    public static final String speechverbs = "speechverbs";
    public static final String newspeechverbs = "newspeechverbs";
    public static final String removespeechverbs = "removespeechverbs";
    public static final String separate = "separate";
    public static final String punctuationtext = "punctuationtext";
    public static final String wordtext = "wordtext";
    public static final String addtitle = "addtitle";
    public static final String doubleword = "doubleword";
    public static final String paragraphlength = "paragraphlength";
    public static final String sentencetext = "sentencetext";
    public static final String sentences = "sentences";
    public static final String paragraphreadability = "paragraphreadability";
    public static final String fr = "fr";
    public static final String fk = "fk";
    public static final String gf = "gf";
    public static final String sentencelength = "sentencelength";
    public static final String sentencecomplexity = "sentencecomplexity";
    public static final String ratio = "ratio";
    public static final String toomanyclauses = "toomanyclauses";
    public static final String clauses = "clauses";
    public static final String startup = "startup";
    public static final String cantopenlastprojecterror = "cantopenlastprojecterror";
    public static final String alreadyrunningerror = "alreadyrunningerror";
    public static final String unabletostarterror = "unabletostarterror";
    public static final String invalidemail = "invalidemail";
    public static final String functionunavailable = "functionunavailable";
    public static final String actions = "actions";
    public static final String fontunavailable = "fontunavailable";
    public static final String chaptersoverwcmaximum = "chaptersoverwcmaximum";
    public static final String multipleoverlimit = "multipleoverlimit";
    public static final String singleoverlimit = "singleoverlimit";
    public static final String multiple = "multiple";
    public static final String single = "single";
    public static final String chaptersoverreadabilitymaximum = "chaptersoverreadabilitymaximum";
    public static final String showdetail = "showdetail";
    public static final String autobackupnotification = "autobackupnotification";
    public static final String backups = "backups";
    public static final String spellchecker = "spellchecker";
    public static final String unabletosetlanguage = "unabletosetlanguage";
    public static final String achievementspanel = "achievementspanel";
    public static final String savechanges = "savechanges";
    public static final String discardchanges = "discardchanges";
    public static final String confirmpopup = "confirmpopup";
    public static final String fullscreen = "fullscreen";
    public static final String showpanelactionerror = "showpanelactionerror";
    public static final String closepanel = "closepanel";
    public static final String discard = "discard";
    public static final String save = "save";
    public static final String editors = "editors";
    public static final String vieweditorerror = "vieweditorerror";
    public static final String vieweditorserror = "vieweditorserror";
    public static final String showregistererror = "showregistererror";
    public static final String deletechapter = "deletechapter";
    public static final String deleteasset = "deleteasset";
    public static final String toolbar = "toolbar";
    public static final String saveideatype = "saveideatype";
    public static final String deleteidea = "deleteidea";
    public static final String deleteideatype = "deleteideatype";
    public static final String viewasset = "viewasset";
    public static final String editasset = "editasset";
    public static final String viewaddasset = "viewaddasset";
    public static final String viewideaboard = "viewideaboard";
    public static final String viewchapterinformation = "viewchapterinformation";
    public static final String viewnote = "viewnote";
    public static final String viewscene = "viewscene";
    public static final String viewoutlineitem = "viewoutlineitem";
    public static final String editchapter = "editchapter";
    public static final String editscene = "editscene";
    public static final String editnote = "editnote";
    public static final String editoutlineitem = "editoutlineitem";
    public static final String viewproblemfindersidebar = "viewproblemfindersidebar";
    public static final String removetag = "removetag";
    public static final String close = "close";
    public static final String send = "send";
    public static final String email = "email";
    public static final String message = "message";
    public static final String errorlabel = "errorlabel";
    public static final String about = "about";
    public static final String keyboardshortcuts = "keyboardshortcuts";
    public static final String contactsupport = "contactsupport";
    public static final String viewuserguide = "viewuserguide";
    public static final String reportbug = "reportbug";
    public static final String whatsnew = "whatsnew";
    public static final String achievements = "achievements";
    public static final String projectmenu = "projectmenu";
    public static final String type = "type";
    public static final String vieweditors = "vieweditors";
    public static final String editorsserviceregister = "editorsserviceregister";
    public static final String showcontacts = "showcontacts";
    public static final String betabug = "betabug";
    public static final String bug = "bug";
    public static final String warmup = "warmup";
    public static final String reportproblem = "reportproblem";
    public static final String sendlogfiles = "sendlogfiles";
    public static final String sendscreenshot = "sendscreenshot";
    public static final String cancel = "cancel";
    public static final String debugmode = "debugmode";
    public static final String enabled = "enabled";
    public static final String disabled = "disabled";
    public static final String dowarmuponstart = "dowarmuponstart";
    public static final String times = "times";
    public static final String unlimited = "unlimited";
    public static final String words100 = "words100";
    public static final String words250 = "words250";
    public static final String words500 = "words500";
    public static final String words1000 = "words1000";
    public static final String hour1 = "hour1";
    public static final String mins10 = "mins10";
    public static final String mins20 = "mins20";
    public static final String mins30 = "mins30";
    public static final String addwarmuperror = "addwarmuperror";
    public static final String getwarmupsprojecterror = "getwarmupsprojecterror";
    public static final String starterror = "starterror";
    public static final String createwarmupsproject = "createwarmupsproject";
    public static final String openwarmupsprojecterror = "openwarmupsprojecterror";
    public static final String startwriting = "startwriting";
    public static final String saveerror = "saveerror";
    public static final String whicheverfirst = "whicheverfirst";
    public static final String andor = "andor";
    public static final String dofor = "dofor";
    public static final String ownprompt = "ownprompt";
    public static final String nextprompt = "nextprompt";
    public static final String previousprompt = "previousprompt";
    public static final String allpromptsexcluded = "allpromptsexcluded";
    public static final String visitlink = "visitlink";
    public static final String weblinks = "weblinks";
    public static final String noshowpromptagain = "noshowpromptagain";
    public static final String chooseprompt = "chooseprompt";
    public static final String acknowledgments = "acknowledgments";
    public static final String makeadonation = "makeadonation";
    public static final String releasenotes = "releasenotes";
    public static final String sourcecode = "sourcecode";
    public static final String website = "website";
    public static final String copyright = "copyright";
    public static final String qwversion = "qwversion";
    public static final String stop = "stop";
    public static final String tipspanel = "tipspanel";
    public static final String next = "next";
    public static final String name = "name";
    public static final String tips = "tips";
    public static final String sidebar = "sidebar";
    public static final String section = "section";
    public static final String appearsinchapters = "appearsinchapters";
    public static final String showinsidebar = "showinsidebar";
    public static final String activetitle = "activetitle";
    public static final String headerpopupmenu = "headerpopupmenu";
    public static final String treepopupmenu = "treepopupmenu";
    public static final String view = "view";
    public static final String sort = "sort";
    public static final String _new = "new";
    public static final String aboutpanel = "aboutpanel";
    public static final String linkedto = "linkedto";
    public static final String editobjecttypeinfo = "editobjecttypeinfo";
    public static final String addfileordocument = "addfileordocument";
    public static final String popupmenu = "popupmenu";
    public static final String user = "user";
    public static final String playsound = "playsound";
    public static final String playsoundinfullscreen = "playsoundinfullscreen";
    public static final String enable = "enable";
    public static final String legacyfields = "legacyfields";
    public static final String aliases = "aliases";
    public static final String webpage = "webpage";
    public static final String textalignments = "textalignments";
    public static final String left = "left";
    public static final String right = "right";
    public static final String justified = "justified";
    public static final String sidebars = "sidebars";
    public static final String othersidebarselect = "othersidebarselect";
    public static final String cantfindeditor = "cantfindeditor";
    public static final String invalidprojectdir = "invalidprojectdir";
    public static final String projectdirisfile = "projectdirisfile";
    public static final String projectdirnotexist = "projectdirnotexist";
    public static final String projectnotexist = "projectnotexist";
    public static final String openerrors = "openerrors";
    public static final String general = "general";
    public static final String writingtargetreachedpopup = "writingtargetreachedpopup";
    public static final String monthly = "monthly";
    public static final String weekly = "weekly";
    public static final String daily = "daily";
    public static final String session = "session";
    public static final String enterpasswordpopup = "enterpasswordpopup";
    public static final String novalue = "novalue";
    public static final String projectalreadyopen = "projectalreadyopen";
    public static final String invalidpassword = "invalidpassword";
    public static final String open = "open";
    public static final String changestatus = "changestatus";
    public static final String restore = "restore";
    public static final String showerror = "showerror";
    public static final String viewbackupsdir = "viewbackupsdir";
    public static final String nobackups = "nobackups";
    public static final String show = "show";
    public static final String deleteitem = "deleteitem";
    public static final String confirmword = "confirmword";
    public static final String startat = "startat";
    public static final String endat = "endat";
    public static final String splitchapter = "splitchapter";
    public static final String newchaptername = "newchaptername";
    public static final String cantreopenproject = "cantreopenproject";
    //public static final String projectexists = "projectexists";
    public static final String renamechapter = "renamechapter";
    //public static final String chapterexists = "chapterexists";
    public static final String newchapter = "newchapter";
    public static final String deletetype = "deletetype";
    public static final String warning = "warning";
    public static final String valueexists = "valueexists";
    public static final String newideatype = "newideatype";
    public static final String editideatype = "editideatype";
    public static final String warmups = "warmups";
    public static final String deletewarmup = "deletewarmup";
    public static final String notifications = "notifications";
    public static final String remove = "remove";
    public static final String filefinder = "filefinder";
    public static final String errormessage = "errormessage";
    public static final String generalmessage = "generalmessage";
    public static final String iconcolumn = "iconcolumn";
    public static final String distractionfreemode = "distractionfreemode";
    public static final String viewitem = "viewitem";
    public static final String moveitem = "moveitem";
    public static final String manage = "manage";
    public static final String rename = "rename";
    public static final String colorchooser = "colorchooser";
    public static final String hex = "hex";
    public static final String red = "red";
    public static final String blue = "blue";
    public static final String green = "green";
    public static final String color = "color";
    public static final String swatch = "swatch";
    public static final String reset = "reset";
    public static final String objectfinder = "objectfinder";
    public static final String renamewarmup = "renamewarmup";
    public static final String editorproject = "editorproject";
    public static final String normal = "normal";
    public static final String editor = "editor";
    public static final String plural = "plural";
    public static final String headercontrols = "headercontrols";
    public static final String loading = "loading";
    public static final String notfound = "notfound";
    public static final String results = "results";
    public static final String findall = "findall";
    public static final String ignored = "ignored";
    public static final String unignore = "unignore";
    public static final String ignore = "ignore";
    public static final String checkbox = "checkbox";
    public static final String overlay = "overlay";
    public static final String deleteall = "deleteall";
    public static final String addsection = "addsection";
    public static final String newobject = "newobject";
    public static final String hidesection = "hidesection";
    public static final String addtag = "addtag";
    public static final String below = "below";
    public static final String tags = "tags";
    public static final String newtag = "newtag";
    public static final String table = "table";
    public static final String finish = "finish";
    public static final String loadallerror = "loadallerror";
    public static final String converttoproject = "converttoproject";
    public static final String entersummaryerror = "entersummaryerror";
    public static final String maxchars = "maxchars";
    public static final String dictionary = "dictionary";
    public static final String synonyms = "synonyms";
    public static final String formatting = "formatting";
    public static final String format = "format";
    public static final String bold = "bold";
    public static final String italic = "italic";
    public static final String underline = "underline";
    public static final String spellcheck = "spellcheck";
    public static final String nosuggestions = "nosuggestions";
    public static final String nosynonyms = "nosynonyms";
    public static final String more = "more";
    public static final String redo = "redo";
    public static final String undo = "undo";
    public static final String cut = "cut";
    public static final String paste = "paste";
    public static final String copy = "copy";
    public static final String textarea = "textarea";
    public static final String charsremaining = "charsremaining";
    public static final String charsover = "charsover";
    public static final String deletetag = "deletetag";
    public static final String prompt = "prompt";
    public static final String create = "create";
    public static final String newprojectpanel = "newprojectpanel";
    public static final String encrypt = "encrypt";
    public static final String password = "password";
    public static final String confirmpassword = "confirmpassword";
    public static final String nopassword = "nopassword";
    public static final String nomatch = "nomatch";
    public static final String savein = "savein";
    
    private static String ID_PART_SEP = ".";
    
    private String languageName = null;
    private String nativeName = null;
    private int version = 1;
    private Date created = null;
    private Map strings = null;
    private Map<String, String> builtIds = new HashMap ();
    
    public LanguageStrings (String jsonData)
    {
        
        Object obj = JSONDecoder.decode (jsonData);
        
        if (!(obj instanceof Map))
        {
            
            throw new IllegalArgumentException ("String does parse to a Map");
            
        }
        
        Map m = (Map) obj;
        
        this.strings = m;
        
        this.languageName = this.getString ("_language",
                                            this.strings);
                
        if (this.languageName == null)
        {
            
            throw new IllegalArgumentException ("No language name found.");
                
        }
                        
        this.nativeName = this.getString ("_nativeName",
                                          this.strings);
                
        if (this.nativeName == null)
        {
            
            throw new IllegalArgumentException ("No language name found.");
                
        }
        
        // Ensure we can resolve everything.
        Iterator iter = m.keySet ().iterator ();
        
        while (iter.hasNext ())
        {
            
            String k = iter.next ().toString ();
            
            List ids = new ArrayList ();
            
            ids.add (k);
            
            Object v = m.get (k);
            
            if (v instanceof Map)
            {
                
                Map om = (Map) v;
                
                this.testMap (om,
                              ids);
                
                continue;
                
            }
            
            if (v instanceof String)
            {
                
                String val = v.toString ();
                
                this.testValue (val,
                                ids);

            }
            
        }        
                                    
    }
    
    public String getNativeName ()
    {
        
        return this.nativeName;
        
    }
    
    public String getLanguageName ()
    {
        
        return this.languageName;
        
    }
    
    private String getString (String id,
                              Map    from)
    {
        
        Object o = from.get (id);
        
        if (o == null)
        {
            
            return null;
            
        }
        
        return o.toString ();
        
    }
    
    private void testValue (String       val,
                            List<String> ids)
    {

        List<String> id = new ArrayList ();
        
        // Convert the current ids to a single id.
        id.add (this.toId (ids));                
        
        val = this.doReplacements (val,
                                   id);
        
        if (val != null)
        {
            
            this.builtIds.put (this.toId (ids),
                               val);
            
        }
        
    }
    
    private void testMap (Map          m,
                          List<String> ids)
    {
        
        // Ensure we can resolve everything.
        Iterator iter = m.keySet ().iterator ();
        
        while (iter.hasNext ())
        {
            
            String k = iter.next ().toString ();
            
            List<String> _ids = new ArrayList (ids);
            
            _ids.add (k);
            
            Object v = m.get (k);
            
            if (v instanceof Map)
            {
                
                Map om = (Map) v;
                
                this.testMap (om,
                              _ids);
                
                continue;
                
            }
            
            if (v instanceof String)
            {
                
                String val = v.toString ();
                
                this.testValue (val,
                                _ids);

            }
            
        }        
        
    }
            
    private String doReplacements (String       val,
                                   List<String> ids)
    {
        
        if (val == null)
        {
            
            throw new IllegalArgumentException ("No value for ids: " + ids);
            
        }
        
        StringBuilder b = new StringBuilder (val);
                
        List<String> thisids = new ArrayList ();
                
        int start = 0;
        
        while ((start = b.indexOf ("${",
                                   start)) > -1)
        {
                  
            int end = b.indexOf ("}",
                                 start);
                    
            if (end > (start + 2))
            {
                            
                String sid = b.substring (start + 2,
                                          end);
                               
                int bind = sid.indexOf ("|");
                String sub = null;
                
                if (bind > -1)
                {
                    
                    sub = sid.substring (0, bind);
                    
                    sid = sid.substring (bind + 1);
                             
                }
                
                String sv = this.builtIds.get (sid);
                
                if (sv == null)
                {
                
                    if (ids.contains (sid))
                    {
                        
                        throw new IllegalArgumentException ("Loop detected between: " + sid + ", and one of: " + ids + ", found in: " +
                                                            val);
                                        
                    } else {
                    
                        if (thisids.contains (sid))
                        {
                            
                            throw new IllegalArgumentException ("Loop detected between: " + sid + ", and one of: " + thisids + ", found in: " +
                                                                val);                    
                            
                        }
    
                    }
                    
                    thisids.add (sid);
                    
                    ids.add (sid);
                    
                    sv = this.getIdValue (sid);

                }
                                
                if (sv == null)
                {
                    
                    throw new IllegalArgumentException ("Unable to find value for: " + sid);
                    
                }
                
                String idv = this.doReplacements (sv,
                                                  ids);
                                    
                if (sub != null)
                {
                    
                    if (sub.equalsIgnoreCase ("u"))
                    {
                        
                        // Uppercase the first letter.
                        
                    }
                    
                    if (sub.equalsIgnoreCase ("l"))
                    {
                        
                        // Lowercase the first letter.
                        //char c[] = idv.toCharArray ();
                        
                        //c[0] = Character.toLowerCase (c[0]);
                        
                        //idv = new String (c);
                        
                    }

                    if (sub.equalsIgnoreCase ("ua"))
                    {
                        
                        // Uppercase the first letter of each word.
                        
                    }
                    
                    if (sub.equalsIgnoreCase ("la"))
                    {
                        
                        // Lowercase the first letter of each word.
                        
                    }

                }
                
                if (idv != null)
                {
                
                    b.replace (start,
                               end + 1,
                               idv);
                
                    start += idv.length ();
                
                } else {
                    
                    start += 2;
                            
                }
                
            } else {
                
                start += 2;
                
            }
        
        }

        return b.toString ();
        
    }
    
    public static String toId (List<String> ids)
    {
        
        return Utils.joinStrings (ids,
                                  ID_PART_SEP);
        
    }
    
    private String getIdValue (String id)
    {
        
        return this.getIdValue (Utils.splitString (id,
                                                   ID_PART_SEP));
        
    }
    
    public String getValue (List<String> idParts)
    {
                
        String v = this.getIdValue (idParts);

        String val = this.builtIds.get (v);
        
        if (val != null)
        {
            
            return val;
            
        }
        
        List ids = new ArrayList ();
        ids.add (this.toId (idParts));
        
        v = this.doReplacements (v,
                                 ids);
        
        if (v != null)
        {
        
            this.builtIds.put (this.toId (idParts),
                               v);
            
        }
        
        return v;
        
    }
    
    private String getIdValue (List<String> idParts)
    {
        
        Map m = this.strings;
        String val = null;
        
        int i = 0;
        
        for (String id : idParts)
        {
            
            i++;
                        
            Object o = m.get (id);
            
            if (o == null)
            {
                
                throw new IllegalArgumentException ("Unable to find part: " +
                                                    id +
                                                    " for id: " +
                                                    this.toId (idParts));
                
            }
            
            if (o instanceof String)
            {
                
                if (i < idParts.size ())
                {
                    
                    throw new IllegalArgumentException ("Expected part: " +
                                                        id +
                                                        " to point to another map, instead is string: " +
                                                        o +
                                                        " for id: " +
                                                        this.toId (idParts));
                    
                }
                
                return o.toString ();
                
            }
            
            if (o instanceof Map)
            {
                
                m = (Map) o;
                
            }
            
        }
        
        return null;        
        
    }
    
}